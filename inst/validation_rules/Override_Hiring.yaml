# Defines checks to be applied to data loaded from the 'Override Hiring' worksheet
# Requires 'validJudges' to be passed as a reference, e.g.
#
# confront(df, rules, ref = list(validJudges = c('Magistrates', 'DJMC')))

rules:
- expr: '`Minimum To Hire` >= 0'
  name: 'Minimum To Hire >=0'
  label: 'Minimum To Hire >=0 per year'
  description: |
    Check min hiring specified is not a negative number
  created: 2021-06-10
  meta:
    severity: error
    worksheet: 'Override Hiring'
    errorMessage: |
      If specifying a min number of judges to hire, this must be a postive 
      number. Please check values entered in Override Hiring worksheet.
  
- expr: '`Minimum To Hire` <= 1000'
  name: 'Sense-check min to hire <=1000'
  label: 'Sense-check min to hire <=1000'
  description: |
    Sense-check min hiring specified is less than or equal to 1,000 per year
  created: 2021-06-10
  meta:
    severity: warning
    worksheet: 'Override Hiring'
    errorMessage: |
      The input sheet specified more than 1000 Judicial Office Holders be hired 
      as a minimum. If this was intentional, please carry on. If not, please 
      check values entered in Override Hiring worksheet.
  
- expr: 'is_unique(Judge, Year)'
  name: 'duplicates'
  label: 'No duplicate rows'
  description: |
    Checks that there are no duplicate combinations of Judge / Year
  created: 2021-06-10
  meta:
    severity: error
    worksheet: 'Override Hiring'
    errorMessage: |
      At least one combination of Judge / Year is duplicated in
      the Override Hiring worksheet. Please check worksheet.

- expr: 'Judge %in% validJudges'
  name: 'Valid Judges'
  label: 'Valid Judges'
  description: |
    Checks that only valid Judges are referred to
  created: 2021-06-10
  meta:
    severity: error
    worksheet: 'Override Hiring'
    errorMessage: |
      At least one row in the Override Hiring worksheet refers to an invalid
      Judge. Referred-to Judges must be as named in the Judges worksheet. 
      Check for typos.
  
- expr: 'Year %in% validYears'
  name: 'Valid Years'
  label: 'Valid Years'
  description: |
    Checks that only valid Years are referred to
  created: 2021-06-10
  meta:
    severity: error
    worksheet: 'Override Hiring'
    errorMessage: |
      At least one row in the Override Hiring worksheet refers to an invalid
      Year. Referred-to Years must be as named in the Years worksheet.
      Check for typos.
  
- expr: 'is_complete(Judge, Year)'
  name: 'No Missing Categories'
  label: 'No Missing Categories'
  description: |
    Checks no NAs in Judge or Year field, which would happen if value invalid
  created: 2021-06-10
  meta:
    severity: error
    worksheet: 'Override Hiring'
    errorMessage: |
      At least one row in the Override Hiring worksheet refers to an invalid
      Judge or Year. These must match those defined in the Judges and Years 
      worksheets. Check for typos.
